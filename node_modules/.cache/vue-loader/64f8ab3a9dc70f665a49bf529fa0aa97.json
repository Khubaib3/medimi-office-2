{"remainingRequest":"C:\\Users\\Deft\\Desktop\\medimi\\medimi-office\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Deft\\Desktop\\medimi\\medimi-office\\src\\views\\hospitalHead\\Statistics.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Deft\\Desktop\\medimi\\medimi-office\\src\\views\\hospitalHead\\Statistics.vue","mtime":1629904843954},{"path":"C:\\Users\\Deft\\Desktop\\medimi\\medimi-office\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Deft\\Desktop\\medimi\\medimi-office\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Deft\\Desktop\\medimi\\medimi-office\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Deft\\Desktop\\medimi\\medimi-office\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBtYXBBY3Rpb25zLCBtYXBTdGF0ZSB9IGZyb20gInZ1ZXgiOw0KaW1wb3J0IG1vbWVudCBmcm9tICJtb21lbnQiOw0KaW1wb3J0IFBpZUNoYXJ0IGZyb20gIkAvY29tcG9uZW50cy9ob3NwaXRhbC9kZXBhcnRtZW50L1BpZUNoYXJ0LnZ1ZSI7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCg0KICBjb21wb25lbnRzOiB7IFBpZUNoYXJ0IH0sDQoNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgZGVwYXJ0bWVudEl0ZW1zOiBbXSwNCiAgICAgIHNlbGVjdGVkRGVwYXJ0bWVudDogbnVsbCwNCiAgICAgIA0KICAgICAgLy8gZGF0ZQ0KICAgICAgc2VhcmNoZWQ6IGZhbHNlLA0KICAgICAgZGF0ZXM6IFtdLA0KICAgICAgZGF0ZU1lbnU6IGZhbHNlLA0KICAgICAgbG9hZGVyOiBmYWxzZSwNCiAgICAgIC8vIGVuZCBkYXRlDQoNCiAgICAgIC8vDQogICAgICBkYXRhT2JqZWN0OiB7fSwNCg0KICAgICAgLy8gc3BhcmtsaW5lDQogICAgICBsYWJlbHM6IFtdLA0KICAgICAgdmFsdWU6IFtdLA0KICAgICAgbWluOiAiIiwNCiAgICAgIG1heDogIiIsDQogICAgICBhdmc6ICIiLA0KDQogICAgICAvLyBjaGFydA0KICAgICAgY2hhcnRMYWJlbHM6IFtdLA0KICAgICAgY2hhcnREYXRhOiBbXSwNCiAgICAgIHBpZURhdGE6IHt9LA0KICAgICAgb3B0aW9uczoge30sDQogICAgfQ0KICB9LA0KDQoNCiAgd2F0Y2g6IHsNCiAgICBzZWxlY3RlZERlcGFydG1lbnQodmFsKSB7DQogICAgICB0aGlzLnBhdGllbnRzID0gW10NCiAgICAgIGxldCBpZCA9IHZhbC5zcGxpdCgnRCcpDQogICAgICB0aGlzLm9uRGVwYXJ0bWVudENoYW5nZShpZFsxXSkNCiAgICB9DQogIH0sDQoNCiAgY29tcHV0ZWQ6IHsNCg0KICAgIGRhdGVSYW5nZVRleHQoKSB7DQogICAgICByZXR1cm4gdGhpcy5kYXRlcy5qb2luKCIgfiAiKTsNCiAgICB9LA0KDQogICAgLi4ubWFwU3RhdGUoew0KICAgICAgZGVwYXJ0bWVudHM6IChzdGF0ZSkgPT4gc3RhdGUuZGVwYXJ0bWVudC5kZXBhcnRtZW50cywNCiAgICB9KSwNCiAgfSwNCg0KICBjcmVhdGVkKCkgew0KICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgbGV0IHN0YXJ0ID0gbW9tZW50KCkNCiAgICAgICAgLnN1YnRyYWN0KDcsICJkYXlzIikNCiAgICAgICAgLmZvcm1hdCgiWVlZWS1NTS1ERCIpOw0KICAgICAgbGV0IGVuZCA9IG1vbWVudCgpLmZvcm1hdCgiWVlZWS1NTS1ERCIpOw0KDQogICAgICB0aGlzLmRhdGVzLnB1c2goc3RhcnQpOw0KICAgICAgdGhpcy5kYXRlcy5wdXNoKGVuZCk7DQogICAgfSwgNTAwKTsNCiAgfSwNCg0KICBhc3luYyBtb3VudGVkKCkgew0KICAgIGlmICh0aGlzLmRlcGFydG1lbnRzLmxlbmd0aCA9PSAwKSB7DQogICAgICBhd2FpdCB0aGlzLmdldERlcGFydG1lbnRzKCk7DQogICAgICB0aGlzLmRlcGFydG1lbnRzLmZvckVhY2goKHZhbHVlLCBrZXkpID0+IHsNCiAgICAgICAgdGhpcy5kZXBhcnRtZW50SXRlbXMucHVzaCh2YWx1ZS5jdXN0b21JZCk7DQogICAgICB9KTsNCiAgICB9DQogICAgdGhpcy5kZXBhcnRtZW50cy5mb3JFYWNoKCh2YWx1ZSwga2V5KSA9PiB7DQogICAgICB0aGlzLmRlcGFydG1lbnRJdGVtcy5wdXNoKHZhbHVlLmN1c3RvbUlkKTsNCiAgICB9KTsNCiAgfSwNCg0KICBtZXRob2RzOiB7DQoNCg0KDQogICAgYXN5bmMgc2VhcmNoQnlSYW5nZSgpIHsNCg0KICAgICAgY29uc3QgaWQgPSB0aGlzLnNlbGVjdGVkRGVwYXJ0bWVudC5zcGxpdCgnRCcpWzFdDQogICAgICBjb25zdCBzdGFydCA9IHRoaXMuZGF0ZXNbMF0NCiAgICAgIGNvbnN0IGVuZCA9IHRoaXMuZGF0ZXNbMV0NCg0KICAgICAgdGhpcy5kYXRhT2JqZWN0ID0gYXdhaXQgdGhpcy5nZXRBcHBvaW50bWVudFJhbmdlKHsgaWQ6IGlkLCBzdGFydDogc3RhcnQsIGVuZDogZW5kfSkNCg0KICAgICAgdGhpcy5kYXRhT2JqZWN0LnNwYXJrbGluZS5mb3JFYWNoKCh2YWwsIGtleSkgPT4gew0KICAgICAgICBsZXQgdG1wVmFyID0gdmFsLmFwcG9pbnRtZW50RGF0ZS5zcGxpdCgnLScpDQogICAgICAgIHRoaXMubGFiZWxzLnB1c2goYCR7dG1wVmFyWzFdfS0ke3RtcFZhclsyXX1gKQ0KICAgICAgICB0aGlzLnZhbHVlLnB1c2godmFsLmNvdW50ZXIpDQogICAgICB9KQ0KDQogICAgICB0aGlzLmRhdGFPYmplY3QuY2hhcnQuZm9yRWFjaCgodmFsLCBrZXkpID0+IHsNCiAgICAgICAgdGhpcy5jaGFydExhYmVscy5wdXNoKHZhbC5kaWFnbm9zdGljKQ0KICAgICAgICB0aGlzLmNoYXJ0RGF0YS5wdXNoKHZhbC5jb3VudGVyKQ0KICAgICAgfSkNCg0KICAgICAgdGhpcy5nZXR0aW5nTWluTWF4KHRoaXMudmFsdWUpDQogICAgICB0aGlzLnNldHVwQ2hhcnQoKQ0KICAgICAgdGhpcy5zZWFyY2hlZCA9IHRydWUNCiAgICB9LA0KDQogICAgZ2V0dGluZ01pbk1heChwYXlsb2FkKSB7DQogICAgICB0aGlzLmF2ZyA9IHBheWxvYWQucmVkdWNlKChhLCB2LCBpKSA9PiAoYSAqIGkgKyB2KSAvIChpICsgMSkpLnRvRml4ZWQoMik7DQogICAgICB0aGlzLm1pbiA9IE1hdGgubWluKC4uLnBheWxvYWQpOw0KICAgICAgdGhpcy5tYXggPSBNYXRoLm1heCguLi5wYXlsb2FkKTsNCiAgICB9LA0KDQogICAgYXN5bmMgb25EZXBhcnRtZW50Q2hhbmdlKCkgew0KICAgICAgDQogICAgfSwNCg0KICAgIHNldHVwQ2hhcnQoKSB7DQogICAgICAodGhpcy5waWVEYXRhID0gew0KICAgICAgICBsYWJlbHM6IHRoaXMuY2hhcnRMYWJlbHMsDQogICAgICAgIGRhdGFzZXRzOiBbDQogICAgICAgICAgew0KICAgICAgICAgICAgbGFiZWw6ICJEYXRhIE9uZSIsDQogICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IFsiI2Y4Nzk3OSIsICIjMzMzIiwgIiM2QUM0QUUiXSwNCiAgICAgICAgICAgIGRhdGE6IHRoaXMuY2hhcnREYXRhLA0KICAgICAgICAgIH0sDQogICAgICAgIF0sDQogICAgICB9KSwNCiAgICAgICAgKHRoaXMub3B0aW9ucyA9IHsNCiAgICAgICAgICBsZWdlbmQ6IHsNCiAgICAgICAgICAgIHBvc2l0aW9uOiAiYm90dG9tIiwNCiAgICAgICAgICAgIHBhZGRpbmc6IDUsDQogICAgICAgICAgfSwNCiAgICAgICAgICByZXNwb25zaXZlOiB0cnVlLA0KICAgICAgICAgIG1haW50YWluQXNwZWN0UmF0aW86IGZhbHNlLA0KICAgICAgICB9KTsNCiAgICB9LA0KDQogICAgLi4ubWFwQWN0aW9ucyh7DQogICAgICBnZXREZXBhcnRtZW50czogImRlcGFydG1lbnQvZ2V0RGVwYXJ0bWVudHMiLA0KICAgICAgZ2V0QXBwb2ludG1lbnRSYW5nZTogImFwcG9pbnRtZW50L2dldEFwcG9pbnRtZW50UmFuZ2UiDQogICAgfSksDQogIH0NCg0KfQ0K"},{"version":3,"sources":["Statistics.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiHA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;AAIA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA","file":"Statistics.vue","sourceRoot":"src/views/hospitalHead","sourcesContent":["<template>\r\n  <v-sheet class=\"pa-5\">\r\n    <div\r\n      class=\"d-flex align-center justify-space-between flex-column flex-sm-row\"\r\n    >\r\n      <h2>Statistiques des services</h2>\r\n      <div style=\"width: 50%\">\r\n        <v-select\r\n          :items=\"departmentItems\"\r\n          v-model=\"selectedDepartment\"\r\n          outlined\r\n          hide-details\r\n          dense\r\n          @change=\"onDepartmentChange()\"\r\n        />\r\n      </div>\r\n    </div>\r\n    <v-card flat v-if=\"selectedDepartment != null\">\r\n      <v-card-text>\r\n        <v-row>\r\n        <v-col cols=\"12\" md=\"8\">\r\n          <v-menu\r\n            v-model=\"dateMenu\"\r\n            :close-on-content-click=\"false\"\r\n            :nudge-right=\"40\"\r\n            transition=\"scale-transition\"\r\n            offset-y\r\n            min-width=\"auto\"\r\n          >\r\n            <template v-slot:activator=\"{ on, attrs }\">\r\n              <v-text-field\r\n                v-model=\"dateRangeText\"\r\n                outlined\r\n                append-icon=\"mdi-calendar\"\r\n                dense\r\n                readonly\r\n                v-bind=\"attrs\"\r\n                v-on=\"on\"\r\n              ></v-text-field>\r\n            </template>\r\n            <v-date-picker\r\n              v-model=\"dates\"\r\n              range\r\n              color=\"primary\"\r\n              locale=\"fr\"\r\n            ></v-date-picker>\r\n          </v-menu>\r\n        </v-col>\r\n        <v-col cols=\"12\" md=\"4\">\r\n          <v-btn\r\n            color=\"secondary\"\r\n            block\r\n            elevation=\"0\"\r\n            @click=\"searchByRange\"\r\n            :loading=\"loader\"\r\n            >Search</v-btn\r\n          >\r\n        </v-col>\r\n      </v-row>\r\n      <v-row>\r\n          <!-- Line -->\r\n          <v-col cols=\"12\" md=\"6\">\r\n            <div v-if=\"searched\" class=\"ml-4\">\r\n              <v-subheader class=\"\">Evolution du flux-patientele </v-subheader>\r\n              <v-divider />\r\n              <v-sheet\r\n                class=\"v-sheet--offset mx-auto mt-10\"\r\n                color=\"primary\"\r\n                elevation=\"3\"\r\n                max-width=\"calc(100% - 32px)\"\r\n              >\r\n                <v-sparkline\r\n                  :labels=\"labels\"\r\n                  :value=\"value\"\r\n                  color=\"white\"\r\n                  line-width=\"2\"\r\n                  padding=\"16\"\r\n                ></v-sparkline>\r\n              </v-sheet>\r\n              <div class=\"ml-4 mt-5\">\r\n                <p class=\"headline secondary--text\">Minimum: {{ min }}</p>\r\n                <p class=\"headline secondary--text\">Moyenne: {{ avg }}</p>\r\n                <p class=\"headline secondary--text\">Maximum: {{ max }}</p>\r\n              </div>\r\n            </div>\r\n          </v-col>\r\n          <!-- Graph -->\r\n          <v-col cols=\"12\" md=\"6\">\r\n            <div v-if=\"searched\" class=\"ml-4\">\r\n              <v-subheader class=\"\"\r\n                >Reparition des maladies diagnostiquees\r\n              </v-subheader>\r\n              <v-divider />\r\n              <PieChart :chartData=\"pieData\" :options=\"options\" class=\"mt-10\" />\r\n            </div>\r\n          </v-col>\r\n        </v-row>\r\n        <v-row class=\"px-5\">\r\n          <v-col cols=\"12\">\r\n            <v-subheader class=\"\">D'autres maladies </v-subheader>\r\n            <v-divider />\r\n          </v-col>\r\n          <v-col class=\"ml-4\" cols=\"12\" sm=\"4\" v-for=\"(item, i) in dataObject.chart\" :key=\"i\">\r\n            {{ item.diagnostic }} - {{ item.counter }}\r\n          </v-col>\r\n        </v-row>\r\n      </v-card-text>\r\n    </v-card>\r\n\r\n  </v-sheet>\r\n</template>\r\n\r\n<script>\r\nimport { mapActions, mapState } from \"vuex\";\r\nimport moment from \"moment\";\r\nimport PieChart from \"@/components/hospital/department/PieChart.vue\";\r\n\r\nexport default {\r\n\r\n  components: { PieChart },\r\n\r\n  data() {\r\n    return {\r\n      departmentItems: [],\r\n      selectedDepartment: null,\r\n      \r\n      // date\r\n      searched: false,\r\n      dates: [],\r\n      dateMenu: false,\r\n      loader: false,\r\n      // end date\r\n\r\n      //\r\n      dataObject: {},\r\n\r\n      // sparkline\r\n      labels: [],\r\n      value: [],\r\n      min: \"\",\r\n      max: \"\",\r\n      avg: \"\",\r\n\r\n      // chart\r\n      chartLabels: [],\r\n      chartData: [],\r\n      pieData: {},\r\n      options: {},\r\n    }\r\n  },\r\n\r\n\r\n  watch: {\r\n    selectedDepartment(val) {\r\n      this.patients = []\r\n      let id = val.split('D')\r\n      this.onDepartmentChange(id[1])\r\n    }\r\n  },\r\n\r\n  computed: {\r\n\r\n    dateRangeText() {\r\n      return this.dates.join(\" ~ \");\r\n    },\r\n\r\n    ...mapState({\r\n      departments: (state) => state.department.departments,\r\n    }),\r\n  },\r\n\r\n  created() {\r\n    setTimeout(() => {\r\n      let start = moment()\r\n        .subtract(7, \"days\")\r\n        .format(\"YYYY-MM-DD\");\r\n      let end = moment().format(\"YYYY-MM-DD\");\r\n\r\n      this.dates.push(start);\r\n      this.dates.push(end);\r\n    }, 500);\r\n  },\r\n\r\n  async mounted() {\r\n    if (this.departments.length == 0) {\r\n      await this.getDepartments();\r\n      this.departments.forEach((value, key) => {\r\n        this.departmentItems.push(value.customId);\r\n      });\r\n    }\r\n    this.departments.forEach((value, key) => {\r\n      this.departmentItems.push(value.customId);\r\n    });\r\n  },\r\n\r\n  methods: {\r\n\r\n\r\n\r\n    async searchByRange() {\r\n\r\n      const id = this.selectedDepartment.split('D')[1]\r\n      const start = this.dates[0]\r\n      const end = this.dates[1]\r\n\r\n      this.dataObject = await this.getAppointmentRange({ id: id, start: start, end: end})\r\n\r\n      this.dataObject.sparkline.forEach((val, key) => {\r\n        let tmpVar = val.appointmentDate.split('-')\r\n        this.labels.push(`${tmpVar[1]}-${tmpVar[2]}`)\r\n        this.value.push(val.counter)\r\n      })\r\n\r\n      this.dataObject.chart.forEach((val, key) => {\r\n        this.chartLabels.push(val.diagnostic)\r\n        this.chartData.push(val.counter)\r\n      })\r\n\r\n      this.gettingMinMax(this.value)\r\n      this.setupChart()\r\n      this.searched = true\r\n    },\r\n\r\n    gettingMinMax(payload) {\r\n      this.avg = payload.reduce((a, v, i) => (a * i + v) / (i + 1)).toFixed(2);\r\n      this.min = Math.min(...payload);\r\n      this.max = Math.max(...payload);\r\n    },\r\n\r\n    async onDepartmentChange() {\r\n      \r\n    },\r\n\r\n    setupChart() {\r\n      (this.pieData = {\r\n        labels: this.chartLabels,\r\n        datasets: [\r\n          {\r\n            label: \"Data One\",\r\n            backgroundColor: [\"#f87979\", \"#333\", \"#6AC4AE\"],\r\n            data: this.chartData,\r\n          },\r\n        ],\r\n      }),\r\n        (this.options = {\r\n          legend: {\r\n            position: \"bottom\",\r\n            padding: 5,\r\n          },\r\n          responsive: true,\r\n          maintainAspectRatio: false,\r\n        });\r\n    },\r\n\r\n    ...mapActions({\r\n      getDepartments: \"department/getDepartments\",\r\n      getAppointmentRange: \"appointment/getAppointmentRange\"\r\n    }),\r\n  }\r\n\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>"]}]}